@{
    ViewData["Title"] = "Quên mật khẩu - CHICKEN FLICK FILM";
}

@model ForgotPasswordViewModel

<!-- Main page with modal trigger -->
<div class="container-fluid p-0">
    <div class="row no-gutters min-vh-100">
        <!-- Left Side - Branding (same as registration page) -->
        <div class="col-lg-6 d-flex align-items-center justify-content-center" style="background-color: #B22222;">
            <div class="text-center text-white">
                <div class="mb-4">
                    <!-- Turkey/Chicken mascot with TV -->
                    <div class="mascot-container mb-4">
                        <svg width="200" height="200" viewBox="0 0 200 200" class="mascot">
                            <!-- Turkey body -->
                            <ellipse cx="100" cy="120" rx="40" ry="35" fill="#8B4513" stroke="#654321" stroke-width="2" />

                            <!-- Turkey head -->
                            <circle cx="100" cy="80" r="25" fill="#D2691E" stroke="#A0522D" stroke-width="2" />

                            <!-- Turkey tail feathers -->
                            <path d="M60 100 Q50 80 45 100 Q40 120 50 130 Q60 125 60 100" fill="#FF4500" stroke="#DC143C" stroke-width="2" />
                            <path d="M65 95 Q55 75 50 95 Q45 115 55 125 Q65 120 65 95" fill="#FF6347" stroke="#DC143C" stroke-width="2" />
                            <path d="M140 100 Q150 80 155 100 Q160 120 150 130 Q140 125 140 100" fill="#FF4500" stroke="#DC143C" stroke-width="2" />
                            <path d="M135 95 Q145 75 150 95 Q155 115 145 125 Q135 120 135 95" fill="#FF6347" stroke="#DC143C" stroke-width="2" />

                            <!-- TV screen -->
                            <rect x="85" y="90" width="30" height="20" fill="#000" stroke="#333" stroke-width="2" rx="2" />
                            <rect x="87" y="92" width="26" height="16" fill="#FF0000" rx="1" />

                            <!-- TV antenna -->
                            <line x1="95" y1="90" x2="90" y2="75" stroke="#666" stroke-width="2" />
                            <line x1="105" y1="90" x2="110" y2="75" stroke="#666" stroke-width="2" />

                            <!-- Eyes -->
                            <circle cx="92" cy="75" r="4" fill="white" />
                            <circle cx="108" cy="75" r="4" fill="white" />
                            <circle cx="92" cy="75" r="2" fill="black" />
                            <circle cx="108" cy="75" r="2" fill="black" />

                            <!-- Beak -->
                            <path d="M100 82 L95 88 L105 88 Z" fill="#FFA500" />

                            <!-- Wattle -->
                            <ellipse cx="100" cy="90" rx="3" ry="6" fill="#DC143C" />

                            <!-- Feet -->
                            <path d="M85 155 L80 165 M85 155 L85 165 M85 155 L90 165" stroke="#FFA500" stroke-width="3" fill="none" />
                            <path d="M115 155 L110 165 M115 155 L115 165 M115 155 L120 165" stroke="#FFA500" stroke-width="3" fill="none" />
                        </svg>
                    </div>
                </div>
                <h1 class="display-4 font-weight-bold mb-0">SIX CHICKENS FILMS</h1>
            </div>
        </div>

        <!-- Right Side - Login Form with Forgot Password Link -->
        <div class="col-lg-6 d-flex align-items-center justify-content-center bg-light">
            <div class="w-100 px-4" style="max-width: 400px;">
                <h2 class="text-center mb-4 text-dark">Đăng nhập</h2>

                <!-- Sample login form -->
                <form class="mb-4">
                    <div class="form-group mb-3">
                        <label for="loginEmail" class="form-label text-dark">Email</label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="Nhập email của bạn">
                    </div>
                    <div class="form-group mb-3">
                        <label for="loginPassword" class="form-label text-dark">Mật khẩu</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="Nhập mật khẩu">
                    </div>
                    <button type="submit" class="btn btn-block mb-3" style="background-color: #B22222; color: white; border: none; padding: 12px; border-radius: 5px;">
                        Đăng nhập
                    </button>
                </form>

                <div class="text-center">
                    <button type="button" class="btn btn-link text-decoration-none p-0" data-toggle="modal" data-target="#forgotPasswordModal" style="color: #B22222;">
                        Quên mật khẩu?
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal fade" id="forgotPasswordModal" tabindex="-1" role="dialog" aria-labelledby="forgotPasswordModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 400px;">
        <div class="modal-content" style="border-radius: 20px; border: 3px solid #007bff;">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="close position-absolute" data-dismiss="modal" aria-label="Close" style="right: 15px; top: 15px; z-index: 1051;">
                    <span aria-hidden="true" style="color: #6c757d; font-size: 24px;">&times;</span>
                </button>
            </div>
            <div class="modal-body text-center px-4 pb-4">
                <!-- Small Turkey Mascot -->
                <div class="mb-3">
                    <svg width="80" height="80" viewBox="0 0 200 200" class="mascot-small">
                        <!-- Turkey body -->
                        <ellipse cx="100" cy="120" rx="40" ry="35" fill="#8B4513" stroke="#654321" stroke-width="2" />

                        <!-- Turkey head -->
                        <circle cx="100" cy="80" r="25" fill="#D2691E" stroke="#A0522D" stroke-width="2" />

                        <!-- Turkey tail feathers -->
                        <path d="M60 100 Q50 80 45 100 Q40 120 50 130 Q60 125 60 100" fill="#FF4500" stroke="#DC143C" stroke-width="2" />
                        <path d="M65 95 Q55 75 50 95 Q45 115 55 125 Q65 120 65 95" fill="#FF6347" stroke="#DC143C" stroke-width="2" />
                        <path d="M140 100 Q150 80 155 100 Q160 120 150 130 Q140 125 140 100" fill="#FF4500" stroke="#DC143C" stroke-width="2" />
                        <path d="M135 95 Q145 75 150 95 Q155 115 145 125 Q135 120 135 95" fill="#FF6347" stroke="#DC143C" stroke-width="2" />

                        <!-- TV screen -->
                        <rect x="85" y="90" width="30" height="20" fill="#000" stroke="#333" stroke-width="2" rx="2" />
                        <rect x="87" y="92" width="26" height="16" fill="#FF0000" rx="1" />

                        <!-- TV antenna -->
                        <line x1="95" y1="90" x2="90" y2="75" stroke="#666" stroke-width="2" />
                        <line x1="105" y1="90" x2="110" y2="75" stroke="#666" stroke-width="2" />

                        <!-- Eyes -->
                        <circle cx="92" cy="75" r="4" fill="white" />
                        <circle cx="108" cy="75" r="4" fill="white" />
                        <circle cx="92" cy="75" r="2" fill="black" />
                        <circle cx="108" cy="75" r="2" fill="black" />

                        <!-- Beak -->
                        <path d="M100 82 L95 88 L105 88 Z" fill="#FFA500" />

                        <!-- Wattle -->
                        <ellipse cx="100" cy="90" rx="3" ry="6" fill="#DC143C" />

                        <!-- Feet -->
                        <path d="M85 155 L80 165 M85 155 L85 165 M85 155 L90 165" stroke="#FFA500" stroke-width="3" fill="none" />
                        <path d="M115 155 L110 165 M115 155 L115 165 M115 155 L120 165" stroke="#FFA500" stroke-width="3" fill="none" />
                    </svg>
                </div>

                <h4 class="mb-3 text-dark font-weight-bold">Quên Mật Khẩu?</h4>

                <p class="text-muted mb-4" style="font-size: 14px;">
                    Vui lòng cung cấp email đăng nhập, chúng tôi sẽ gửi link kích hoạt cho bạn.
                </p>

                @using (Html.BeginForm("ForgotPassword", "Account", FormMethod.Post, new { @id = "forgotPasswordForm" }))
                {
                    @Html.AntiForgeryToken()

                    <div class="form-group mb-3 text-left">
                        <label for="Email" class="form-label text-muted small">Email</label>
                        @Html.TextBoxFor(m => m.Email, new
                            {
                                @class = "form-control",
                                placeholder = "Nhập Email",
                                required = "required",
                                style = "border-radius: 8px; border: 1px solid #ced4da;"
                            })
                        @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger small" })
                    </div>

                    <button type="submit" class="btn btn-block font-weight-bold" style="background-color: #ff8c00; color: white; border: none; padding: 12px; border-radius: 8px; text-transform: uppercase;">
                        Cấp lại mật khẩu
                    </button>
                }
            </div>
        </div>
    </div>
</div>

<style>
    .mascot-container {
        animation: float 3s ease-in-out infinite;
    }

    .mascot-small {
        animation: float 2s ease-in-out infinite;
    }

    @@keyframes float {
        0% { transform: translateY(0px); }
        50% { transform: translateY(-8px); }
        100% { transform: translateY(0px); }
    }

    .min-vh-100 {
        min-height: 100vh;
    }

    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    .modal-content {
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .btn:hover {
        opacity: 0.9;
        transform: translateY(-1px);
        transition: all 0.2s ease;
    }

    .close:hover {
        opacity: 0.7;
    }

    /* Custom modal backdrop */
    .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.3);
    }

    /* Responsive adjustments */
    @@media (max-width: 576px) {
        .modal-dialog {
            margin: 20px;
            max-width: calc(100% - 40px) !important;
        }
    }
</style>

<script>
    // Form submission handling
    document.getElementById('forgotPasswordForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const email = document.querySelector('input[name="Email"]').value;

        if (!email) {
            alert('Vui lòng nhập email của bạn');
            return;
        }

        // Here you would typically send the form data to your server
        // For demo purposes, we'll show a success message
        alert('Link đặt lại mật khẩu đã được gửi đến email của bạn!');

        // Close the modal
        $('#forgotPasswordModal').modal('hide');

        // Reset form
        this.reset();
    });

    // Reset form when modal is closed
    $('#forgotPasswordModal').on('hidden.bs.modal', function () {
        document.getElementById('forgotPasswordForm').reset();
    });

    // Auto-focus email input when modal opens
    $('#forgotPasswordModal').on('shown.bs.modal', function () {
        document.querySelector('input[name="Email"]').focus();
    });
</script>